<div class="h-100 navbar d-flex flex-column align-items-start justify-content-start">


    <div class="ps-1 pe-1 w-100">
        <div class="ps-2 pe-2 nav-item">
            <a class="nav-link" [routerLink]="'/data-wizard/'+account.guid + '/account-setup'"
                [routerLinkActive]="['active']" [routerLinkActiveOptions]="{ exact: true }">
                <span class="fa fa-gear"></span>
                Corporate Settings
            </a>
        </div>
        <div class="p-2 w-100">
            <hr class="my-1">
        </div>
        <div class="ps-2 pe-2 nav-item">
            <a class="nav-link" [routerLink]="'/data-wizard/'+account.guid+'/import-data/upload-files'"
                [routerLinkActive]="['active']" [routerLinkActiveOptions]="{ exact: true }">
                <span class="fa fa-upload"></span>
                Data Upload
            </a>
        </div>
        <ng-container *ngFor="let fileReference of fileReferences">
            <ng-template [ngIf]="fileReference.isTemplate" [ngIfElse]="nonTemplateBlock">
                <div class="ps-2 pe-2 nav-item">
                    <a class="nav-link"
                        [routerLink]="'/data-wizard/'+account.guid+'/import-data/process-template-file/' +fileReference.id"
                        [routerLinkActive]="['active']" [routerLinkActiveOptions]="{ exact: true }">
                        {{fileReference.name}}
                    </a>
                </div>
                <div class="ps-2 pe-2 nav-item">
                    <a class="nav-link"
                        [routerLink]="'/data-wizard/'+account.guid+'/import-data/process-template-file/' +fileReference.id +'/facilities'"
                        [routerLinkActive]="['active']" [routerLinkActiveOptions]="{ exact: true }">
                        Facilities
                    </a>
                </div>
                <div class="ps-2 pe-2 nav-item">
                    <a class="nav-link"
                        [routerLink]="'/data-wizard/'+account.guid+'/import-data/process-template-file/' +fileReference.id +'/meters'"
                        [routerLinkActive]="['active']" [routerLinkActiveOptions]="{ exact: true }">
                        Meters
                    </a>
                </div>
                <div class="ps-2 pe-2 nav-item">
                    <a class="nav-link"
                        [routerLink]="'/data-wizard/'+account.guid+'/import-data/process-template-file/' +fileReference.id +'/meter-readings'"
                        [routerLinkActive]="['active']" [routerLinkActiveOptions]="{ exact: true }">
                        Readings
                    </a>
                </div>
                <div class="ps-2 pe-2 nav-item">
                    <a class="nav-link"
                        [routerLink]="'/data-wizard/'+account.guid+'/import-data/process-template-file/' +fileReference.id +'/predictors'"
                        [routerLinkActive]="['active']" [routerLinkActiveOptions]="{ exact: true }">
                        Predictors
                    </a>
                </div>
            </ng-template>
            <ng-template #nonTemplateBlock>

            </ng-template>
        </ng-container>
        <div class="p-2 w-100">
            <hr class="my-1">
        </div>
        <div class="ps-2 pe-2 nav-item">
            <a class="nav-link" (click)="toggleFacilitiesOpen()">
                <span class="fa"
                    [ngClass]="{'fa-folder-open': account.sidebarFacilitiesOpen, 'fa-folder': !account.sidebarFacilitiesOpen}"></span>
                Facilities
            </a>
        </div>
        <div class="sidebar-section" *ngIf="account.sidebarFacilitiesOpen">
            <div class="ps-2 pe-2 nav-item">
                <a class="nav-link" [routerLink]="'/data-wizard/'+account.guid+'/facilities'"
                    [routerLinkActive]="['active']" [routerLinkActiveOptions]="{ exact: true }">
                    <span class="fa fa-list"></span>
                    Manage Facilities
                </a>
            </div>
            <ng-container *ngFor="let facility of facilities">
                <div class="ps-2 pe-2 nav-item">
                    <a class="nav-link" (click)="toggleFacilityOpen(facility)"
                        [ngClass]="{'active': facility.guid == selectedFacility.guid}">
                        <span class="fa"
                            [ngClass]="{'fa-folder-open': facility.sidebarOpen, 'fa-folder': !facility.sidebarOpen}"></span>
                        {{facility.name}}
                    </a>
                </div>
                <div class="sidebar-section" *ngIf="facility.sidebarOpen">
                    <div class="ps-2 pe-2 nav-item">
                        <a class="nav-link" [routerLink]="'/data-wizard/'+account.guid+'/facilities/'+facility.guid"
                            [routerLinkActive]="['active']" [routerLinkActiveOptions]="{ exact: true }">
                            <span class="fa fa-gear"></span> Facility Settings
                        </a>
                    </div>
                    <div class="ps-2 pe-2 nav-item">
                        <a class="nav-link" (click)="toggleFacilityMetersOpen(facility)"
                            [ngClass]="{'active': (selectedMeter?.facilityId == facility.guid)}">
                            <span class="fa"
                                [ngClass]="{'fa-folder-open': facility.sidebarMetersOpen, 'fa-folder': !facility.sidebarMetersOpen}"></span>
                            Meters
                        </a>
                    </div>
                    <div class="sidebar-section" *ngIf="facility.sidebarMetersOpen">
                        <div class="ps-2 pe-2 nav-item">
                            <a class="nav-link"
                                [routerLink]="'/data-wizard/'+account.guid+'/facilities/'+facility.guid+'/meters'"
                                [routerLinkActive]="['active']" [routerLinkActiveOptions]="{ exact: true }">
                                <span class="fa fa-list"></span> Manage Meters
                            </a>
                        </div>
                        <ng-container *ngFor="let meter of facility.guid | facilityMetersList:accountMeters">
                            <div class="ps-2 pe-2 nav-item">
                                <a class="nav-link" (click)="toggleMeterOpen(meter)"
                                    [ngClass]="{'active': meter.guid == selectedMeter?.guid}">
                                    <span class="fa"
                                        [ngClass]="{'fa-folder-open': meter.sidebarOpen, 'fa-folder': !meter.sidebarOpen}"></span>
                                    {{meter.name}}
                                </a>
                            </div>
                            <div class="sidebar-section" *ngIf="meter.sidebarOpen">
                                <div class="ps-2 pe-2 nav-item">
                                    <a class="nav-link"
                                        [routerLink]="'/data-wizard/'+account.guid+'/facilities/'+facility.guid+'/meters/meter/'+meter.guid"
                                        [routerLinkActive]="['active']" [routerLinkActiveOptions]="{ exact: true }">
                                        <span class="fa fa-gear"></span> Meter Settings
                                    </a>
                                </div>
                                <div class="ps-2 pe-2 nav-item">
                                    <a class="nav-link"
                                        [routerLink]="'/data-wizard/'+account.guid+'/facilities/'+facility.guid+'/meters/meter-data/'+meter.guid"
                                        [routerLinkActive]="['active']" [routerLinkActiveOptions]="{ exact: true }">
                                        <span class="fa fa-table"></span> Meter Readings
                                    </a>
                                </div>
                            </div>
                        </ng-container>
                    </div>
                    <div class="ps-2 pe-2 nav-item">
                        <a class="nav-link" (click)="toggleFacilityPredictorsOpen(facility)">
                            <span class="fa"
                                [ngClass]="{'fa-folder-open': facility.sidebarPredictorsOpen, 'fa-folder': !facility.sidebarPredictorsOpen}"></span>
                            Predictors
                        </a>
                    </div>
                    <div class="sidebar-section" *ngIf="facility.sidebarPredictorsOpen">
                        <div class="ps-2 pe-2 nav-item">
                            <a class="nav-link"
                                [routerLink]="'/data-wizard/'+account.guid+'/facilities/'+facility.guid+'/predictors'"
                                [routerLinkActive]="['active']" [routerLinkActiveOptions]="{ exact: true }">
                                <span class="fa fa-list"></span> Manage Predictors
                            </a>
                        </div>
                        <ng-container *ngFor="let predictor of facility.guid | facilityPredictorList:accountPredictors">
                            <div class="ps-2 pe-2 nav-item">
                                <a class="nav-link" (click)="togglePredictorOpen(predictor)">
                                    <span class="fa"
                                        [ngClass]="{'fa-folder-open': predictor.sidebarOpen, 'fa-folder': !predictor.sidebarOpen}"></span>
                                    {{predictor.name}}
                                </a>
                            </div>
                            <div class="sidebar-section" *ngIf="predictor.sidebarOpen">
                                <div class="ps-2 pe-2 nav-item">
                                    <a class="nav-link"
                                        [routerLink]="'/data-wizard/'+account.guid+'/facilities/'+facility.guid+'/predictors/predictor/'+predictor.guid"
                                        [routerLinkActive]="['active']" [routerLinkActiveOptions]="{ exact: true }">
                                        <span class="fa fa-gear"></span> Predictor Settings
                                    </a>
                                </div>
                                <div class="ps-2 pe-2 nav-item">
                                    <a class="nav-link"
                                        [routerLink]="'/data-wizard/'+account.guid+'/facilities/'+facility.guid+'/predictors/predictor-data/'+predictor.guid"
                                        [routerLinkActive]="['active']" [routerLinkActiveOptions]="{ exact: true }">
                                        <span class="fa fa-table"></span> Predictor Data
                                    </a>
                                </div>
                            </div>
                        </ng-container>
                    </div>
                </div>
            </ng-container>
        </div>
    </div>
    <div class="p-2 w-100">
        <hr class="my-1">
    </div>
</div>