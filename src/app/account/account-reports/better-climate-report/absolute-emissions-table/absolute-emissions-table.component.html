<h4>
    Absolute Emissions (Metric tonne CO<sub>2</sub>e)
</h4>
<table class="table utility-data table-sm table-bordered table-hover">
    <thead>
        <tr class="table-mh">
            <th [ngStyle]="{'width.%': cellWidth}"></th>
            <th *ngIf="betterClimateReportSetup.includeEmissionsInTables" class="text-center"
                [attr.colspan]="yearDetails.length">
                Emissions<br>
                (Metric tons CO<sub>2</sub>e)
            </th>
            <th *ngIf="betterClimateReportSetup.includePercentReductionsInTables" class="text-center"
                [attr.colspan]="yearDetails.length">
                Percent Reduction
            </th>
            <th *ngIf="betterClimateReportSetup.includePercentContributionsInTables" class="text-center"
                [attr.colspan]="yearDetails.length">
                Percent Contribution
            </th>

        </tr>
        <tr>
            <th>

            </th>
            <ng-container *ngIf="betterClimateReportSetup.includeEmissionsInTables">
                <th *ngFor="let yearDetail of yearDetails">
                    {{yearDetail.year}}
                </th>
            </ng-container>
            <ng-container *ngIf="betterClimateReportSetup.includePercentReductionsInTables">
                <th *ngFor="let yearDetail of yearDetails">
                    {{yearDetail.year}}
                </th>
            </ng-container>
            <ng-container *ngIf="betterClimateReportSetup.includePercentContributionsInTables">
                <th *ngFor="let yearDetail of yearDetails">
                    {{yearDetail.year}}
                </th>
            </ng-container>
        </tr>
    </thead>
    <tbody>
        <tr>
            <th>
                Scope 1 Emissions
            </th>
            <ng-container *ngIf="betterClimateReportSetup.includeEmissionsInTables">
                <td *ngFor="let yearDetail of yearDetails">
                    <ng-container *ngIf="yearDetail.emissionsResults.totalScope1Emissions">
                        {{yearDetail.emissionsResults.totalScope1Emissions | customNumber}}
                    </ng-container>
                    <ng-container *ngIf="!yearDetail.emissionsResults.totalScope1Emissions">
                        &mdash;
                    </ng-container>
                </td>
            </ng-container>
            <ng-container *ngIf="betterClimateReportSetup.includePercentReductionsInTables">
                <td *ngFor="let yearDetail of yearDetails">
                    <ng-container *ngIf="yearDetail.percentReductions.totalScope1Emissions">
                        {{yearDetail.percentReductions.totalScope1Emissions| number:'1.0-2'}} %
                    </ng-container>
                    <ng-container *ngIf="!yearDetail.percentReductions.totalScope1Emissions">
                        &mdash;
                    </ng-container>
                </td>
            </ng-container>
            <ng-container *ngIf="betterClimateReportSetup.includePercentContributionsInTables">
                <td *ngFor="let yearDetail of yearDetails">
                    <ng-container *ngIf="yearDetail.totalContribution.totalScope1Emissions">
                        {{yearDetail.totalContribution.totalScope1Emissions | number:'1.0-2'}} %
                    </ng-container>
                    <ng-container *ngIf="!yearDetail.totalContribution.totalScope1Emissions">
                        &mdash;
                    </ng-container>
                </td>
            </ng-container>
        </tr>
        <tr *ngIf="hasStationary">
            <td class="ps-3">
                Stationary Emissions
            </td>
            <ng-container *ngIf="betterClimateReportSetup.includeEmissionsInTables">
                <td *ngFor="let yearDetail of yearDetails">
                    <ng-container *ngIf="yearDetail.emissionsResults.stationaryEmissions">
                        {{yearDetail.emissionsResults.stationaryEmissions | customNumber}}
                    </ng-container>
                    <ng-container *ngIf="!yearDetail.emissionsResults.stationaryEmissions">
                        &mdash;
                    </ng-container>
                </td>
            </ng-container>
            <ng-container *ngIf="betterClimateReportSetup.includePercentReductionsInTables">
                <td *ngFor="let yearDetail of yearDetails">
                    <ng-container *ngIf="yearDetail.percentReductions.stationaryEmissions">
                        {{yearDetail.percentReductions.stationaryEmissions| number:'1.0-2'}} %
                    </ng-container>
                    <ng-container *ngIf="!yearDetail.percentReductions.stationaryEmissions">
                        &mdash;
                    </ng-container>
                </td>
            </ng-container>
            <ng-container *ngIf="betterClimateReportSetup.includePercentContributionsInTables">
                <td *ngFor="let yearDetail of yearDetails">
                    <ng-container *ngIf="yearDetail.totalContribution.stationaryEmissions">
                        {{yearDetail.totalContribution.stationaryEmissions | number:'1.0-2'}} %
                    </ng-container>
                    <ng-container *ngIf="!yearDetail.totalContribution.stationaryEmissions">
                        &mdash;
                    </ng-container>
                </td>
            </ng-container>
        </tr>
        <tr *ngIf="hasMobile">
            <td class="ps-3">
                Mobile Emissions
            </td>
            <ng-container *ngIf="betterClimateReportSetup.includeEmissionsInTables">
                <td *ngFor="let yearDetail of yearDetails">
                    <ng-container *ngIf="yearDetail.emissionsResults.mobileTotalEmissions">
                        {{yearDetail.emissionsResults.mobileTotalEmissions | customNumber}}
                    </ng-container>
                    <ng-container *ngIf="!yearDetail.emissionsResults.mobileTotalEmissions">
                        &mdash;
                    </ng-container>
                </td>
            </ng-container>
            <ng-container *ngIf="betterClimateReportSetup.includePercentReductionsInTables">
                <td *ngFor="let yearDetail of yearDetails">
                    <ng-container *ngIf="yearDetail.percentReductions.mobileTotalEmissions">
                        {{yearDetail.percentReductions.mobileTotalEmissions| number:'1.0-2'}} %
                    </ng-container>
                    <ng-container *ngIf="!yearDetail.percentReductions.mobileTotalEmissions">
                        &mdash;
                    </ng-container>
                </td>
            </ng-container>
            <ng-container *ngIf="betterClimateReportSetup.includePercentContributionsInTables">
                <td *ngFor="let yearDetail of yearDetails">
                    <ng-container *ngIf="yearDetail.totalContribution.mobileTotalEmissions">
                        {{yearDetail.totalContribution.mobileTotalEmissions | number:'1.0-2'}} %
                    </ng-container>
                    <ng-container *ngIf="!yearDetail.totalContribution.mobileTotalEmissions">
                        &mdash;
                    </ng-container>
                </td>
            </ng-container>
        </tr>
        <tr *ngIf="hasFugitive">
            <td class="ps-3">
                Fugitive Emissions
            </td>
            <ng-container *ngIf="betterClimateReportSetup.includeEmissionsInTables">
                <td *ngFor="let yearDetail of yearDetails">
                    <ng-container *ngIf="yearDetail.emissionsResults.fugitiveEmissions">
                        {{yearDetail.emissionsResults.fugitiveEmissions | customNumber}}
                    </ng-container>
                    <ng-container *ngIf="!yearDetail.emissionsResults.fugitiveEmissions">
                        &mdash;
                    </ng-container>
                </td>
            </ng-container>
            <ng-container *ngIf="betterClimateReportSetup.includePercentReductionsInTables">
                <td *ngFor="let yearDetail of yearDetails">
                    <ng-container *ngIf="yearDetail.percentReductions.fugitiveEmissions">
                        {{yearDetail.percentReductions.fugitiveEmissions| number:'1.0-2'}} %
                    </ng-container>
                    <ng-container *ngIf="!yearDetail.percentReductions.fugitiveEmissions">
                        &mdash;
                    </ng-container>
                </td>
            </ng-container>
            <ng-container *ngIf="betterClimateReportSetup.includePercentContributionsInTables">
                <td *ngFor="let yearDetail of yearDetails">
                    <ng-container *ngIf="yearDetail.totalContribution.fugitiveEmissions">
                        {{yearDetail.totalContribution.fugitiveEmissions | number:'1.0-2'}} %
                    </ng-container>
                    <ng-container *ngIf="!yearDetail.totalContribution.fugitiveEmissions">
                        &mdash;
                    </ng-container>
                </td>
            </ng-container>
        </tr>
        <tr *ngIf="hasProcess">
            <td class="ps-3">
                Process Emissions
            </td>
            <ng-container *ngIf="betterClimateReportSetup.includeEmissionsInTables">
                <td *ngFor="let yearDetail of yearDetails">
                    <ng-container *ngIf="yearDetail.emissionsResults.processEmissions">
                        {{yearDetail.emissionsResults.processEmissions | customNumber}}
                    </ng-container>
                    <ng-container *ngIf="!yearDetail.emissionsResults.processEmissions">
                        &mdash;
                    </ng-container>
                </td>
            </ng-container>
            <ng-container *ngIf="betterClimateReportSetup.includePercentReductionsInTables">
                <td *ngFor="let yearDetail of yearDetails">
                    <ng-container *ngIf="yearDetail.percentReductions.processEmissions">
                        {{yearDetail.percentReductions.processEmissions| number:'1.0-2'}} %
                    </ng-container>
                    <ng-container *ngIf="!yearDetail.percentReductions.processEmissions">
                        &mdash;
                    </ng-container>
                </td>
            </ng-container>
            <ng-container *ngIf="betterClimateReportSetup.includePercentContributionsInTables">
                <td *ngFor="let yearDetail of yearDetails">
                    <ng-container *ngIf="yearDetail.totalContribution.processEmissions">
                        {{yearDetail.totalContribution.processEmissions | number:'1.0-2'}} %
                    </ng-container>
                    <ng-container *ngIf="!yearDetail.totalContribution.processEmissions">
                        &mdash;
                    </ng-container>
                </td>
            </ng-container>
        </tr>
        <tr>
            <th>
                Scope 2 Emissions (Location-Based) from Electricity & District Energy
            </th>
            <ng-container *ngIf="betterClimateReportSetup.includeEmissionsInTables">
                <td *ngFor="let yearDetail of yearDetails">
                    <ng-container *ngIf="yearDetail.emissionsResults.scope2LocationEmissions">
                        {{yearDetail.emissionsResults.scope2LocationEmissions | customNumber}}
                    </ng-container>
                    <ng-container *ngIf="!yearDetail.emissionsResults.scope2LocationEmissions">
                        &mdash;
                    </ng-container>
                </td>
            </ng-container>
            <ng-container *ngIf="betterClimateReportSetup.includePercentReductionsInTables">
                <td *ngFor="let yearDetail of yearDetails">
                    <ng-container *ngIf="yearDetail.percentReductions.scope2LocationEmissions">
                        {{yearDetail.percentReductions.scope2LocationEmissions| number:'1.0-2'}} %
                    </ng-container>
                    <ng-container *ngIf="!yearDetail.percentReductions.scope2LocationEmissions">
                        &mdash;
                    </ng-container>
                </td>
            </ng-container>
            <ng-container *ngIf="betterClimateReportSetup.includePercentContributionsInTables">
                <td *ngFor="let yearDetail of yearDetails">
                    <ng-container
                        *ngIf="yearDetail.totalContribution.scope2LocationEmissions && betterClimateReportSetup.emissionsDisplay == 'location'">
                        {{yearDetail.totalContribution.scope2LocationEmissions | number:'1.0-2'}} %
                    </ng-container>
                    <ng-container
                        *ngIf="!yearDetail.totalContribution.scope2LocationEmissions || betterClimateReportSetup.emissionsDisplay == 'market'">
                        &mdash;
                    </ng-container>
                </td>
            </ng-container>
        </tr>
        <tr>
            <th>
                Scope 2 Emissions (Market-Based) from Electricity & District Energy
            </th>
            <ng-container *ngIf="betterClimateReportSetup.includeEmissionsInTables">
                <td *ngFor="let yearDetail of yearDetails">
                    <ng-container *ngIf="yearDetail.emissionsResults.scope2MarketEmissions">
                        {{yearDetail.emissionsResults.scope2MarketEmissions | customNumber}}
                    </ng-container>
                    <ng-container *ngIf="!yearDetail.emissionsResults.scope2MarketEmissions">
                        &mdash;
                    </ng-container>
                </td>
            </ng-container>
            <ng-container *ngIf="betterClimateReportSetup.includePercentReductionsInTables">
                <td *ngFor="let yearDetail of yearDetails">
                    <ng-container *ngIf="yearDetail.percentReductions.scope2MarketEmissions">
                        {{yearDetail.percentReductions.scope2MarketEmissions| number:'1.0-2'}} %
                    </ng-container>
                    <ng-container *ngIf="!yearDetail.percentReductions.scope2MarketEmissions">
                        &mdash;
                    </ng-container>
                </td>
            </ng-container>
            <ng-container *ngIf="betterClimateReportSetup.includePercentContributionsInTables">
                <td *ngFor="let yearDetail of yearDetails">
                    <ng-container
                        *ngIf="yearDetail.totalContribution.scope2MarketEmissions && betterClimateReportSetup.emissionsDisplay == 'market'">
                        {{yearDetail.totalContribution.scope2MarketEmissions| number:'1.0-2'}} %
                    </ng-container>
                    <ng-container
                        *ngIf="!yearDetail.totalContribution.scope2MarketEmissions || betterClimateReportSetup.emissionsDisplay == 'location'">
                        &mdash;
                    </ng-container>
                </td>
            </ng-container>
        </tr>
        <tr>
            <th>
                Total Emissions (Metric Tons)
            </th>
            <ng-container *ngIf="betterClimateReportSetup.includeEmissionsInTables">
                <th *ngFor="let yearDetail of yearDetails">
                    <ng-container *ngIf="yearDetail.totalEmissions">
                        {{yearDetail.totalEmissions | customNumber}}
                    </ng-container>
                    <ng-container *ngIf="!yearDetail.totalEmissions">
                        &mdash;
                    </ng-container>
                </th>
            </ng-container>
            <ng-container *ngIf="betterClimateReportSetup.includePercentReductionsInTables">
                <th *ngFor="let yearDetail of yearDetails">
                    <ng-container *ngIf="yearDetail.percentEmissionsReduction">
                        {{yearDetail.percentEmissionsReduction| number:'1.0-2'}} %
                    </ng-container>
                    <ng-container *ngIf="!yearDetail.percentEmissionsReduction">
                        &mdash;
                    </ng-container>
                </th>
            </ng-container>
            <ng-container *ngIf="betterClimateReportSetup.includePercentContributionsInTables">
                <th *ngFor="let yearDetail of yearDetails">
                    <ng-container *ngIf="yearDetail.percentEmissionsReduction">
                        {{yearDetail.percentEmissionsReduction| number:'1.0-2'}} %
                    </ng-container>
                    <ng-container *ngIf="!yearDetail.percentEmissionsReduction">
                        &mdash;
                    </ng-container>
                </th>
            </ng-container>
        </tr>
        <!--TODO: Don't think we have bioenergy or biomass emissions yet...-->
        <!-- <tr>
            <th>
                If Applicable: Bioenergy and Biomass Emissions
            </th>
            <td *ngFor="let yearDetail of yearDetails">

            </td>
        </tr> -->
    </tbody>
</table>
<div class="alert alert-info text-center" *ngIf="betterClimateReportSetup.emissionsDisplay == 'market'">
    Total Emissions shown using Market-Based Scope 2 Emissions
</div>
<div class="alert alert-info text-center" *ngIf="betterClimateReportSetup.emissionsDisplay == 'location'">
    Total Emissions shown using Location-Based Scope 2 Emissions
</div>