<div *ngIf="regressionGroupItems.length > 0" class="w-100 justify-content-center">
    <div class="text-center" *ngIf="!analysisReportSetup.includeProblemsInformation
 && !analysisReportSetup.includeExecutiveSummary">
        <h3>
            {{selectedReport.name}}
        </h3>
    </div>

    <div class="text-center mb-4" *ngIf="!analysisReportSetup.includeProblemsInformation
 && !analysisReportSetup.includeExecutiveSummary">
        <h6>
            Generated By VERIFI
        </h6>
    </div>
    <div>
        <h4 class="mb-0">
            Data Validation Tables
        </h4>
    </div>

    <div *ngFor="let model of regressionGroupItems">
        <table class="table table-bordered table-responsive mt-5">
            <thead class="table-secondary">
                <tr>
                    <th>
                        Facility
                    </th>
                    <th>
                        Group
                    </th>
                    <th>
                        Model Year
                    </th>
                    <th>
                        Variable p-Values
                    </th>
                    <th>
                        R2
                    </th>
                    <th>
                        Adjusted R2
                    </th>
                    <th>
                        Model p-Value
                    </th>
                    <th>
                        Formula
                    </th>
                    <th>
                        Model Notes
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        {{model.facilityId | facilityName}}
                    </td>
                    <td>
                        {{model.group.idbGroupId | groupName}}
                    </td>
                    <td>
                        {{ model.group.regressionModelYear }}
                    </td>
                    <td *ngIf="!model.selectedModel.errorModeling">
                        <span *ngFor="let pVal of model.selectedModel.t.p; let index = index">
                            <span *ngIf="index != 0">{{model.selectedModel.predictorVariables[index-1].name}}:
                                {{pVal | number:'0.2-2'}}
                                <br>
                            </span>
                        </span>
                    </td>
                    <td *ngIf="!model.selectedModel.errorModeling">
                        {{model.selectedModel.R2 | number:'0.3-3'}}
                    </td>
                    <td *ngIf="!model.selectedModel.errorModeling">
                        {{model.selectedModel.adjust_R2 | number:'0.3-3'}}
                    </td>
                    <td>
                        {{model.selectedModel.modelPValue | number:'0.2-2'}}
                    </td>
                    <td *ngIf="!model.selectedModel.errorModeling">
                        <span *ngFor="let coefVal of model.selectedModel.coef; let index = index;">
                            <span *ngIf="index == 0">{{coefVal| regressionNumber}}</span>
                            <span *ngIf="index != 0">({{coefVal|
                                regressionNumber}}*{{model.selectedModel.predictorVariables[index-1].name}})</span>
                            <span *ngIf="index != model.selectedModel.coef.length-1"> +</span>
                        </span>
                    </td>
                    <td>
                        <span *ngFor="let notes of model.selectedModel.modelNotes">
                            {{notes}}<br>
                        </span>
                        <span *ngIf="model.selectedModel.modelNotes.length == 0">
                            &mdash;
                        </span>
                    </td>
                </tr>
            </tbody>
        </table>

        <div class="d-flex w-100 justify-content-center mt-5">
            <div class="pe-2">
                <table class="table table-sm sep-table">
                    <thead>
                        <tr>
                            <th></th>
                            <th></th>
                            <th *ngFor="let sepValidation of model.selectedModel.SEPValidation">
                                {{sepValidation.predictorVariable}}
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="bg-white border-top">
                            <td></td>
                            <td>
                                Mean Report Year Value
                            </td>
                            <td *ngFor="let sepValidation of model.selectedModel.SEPValidation">
                                {{sepValidation.meanReportYear | customNumber}}
                            </td>
                        </tr>
                        <tr class="bg-white">
                            <td></td>
                            <td>
                                Mean Baseline Year Value
                            </td>
                            <td *ngFor="let sepValidation of model.selectedModel.SEPValidation">
                                {{sepValidation.meanBaselineYear | customNumber}}
                            </td>
                        </tr>
                        <tr class="bg-white border-top">
                            <td>
                                Range 1
                            </td>
                            <td>
                                Minimum of Model Variable
                            </td>
                            <td *ngFor="let sepValidation of model.selectedModel.SEPValidation"
                                [ngClass]="{'alert-danger': !sepValidation.modelMinValid}">
                                {{sepValidation.modelMin | customNumber}}
                            </td>
                        </tr>
                        <tr class="bg-white">
                            <td></td>
                            <td>
                                Maximum of Model Variable
                            </td>
                            <td *ngFor="let sepValidation of model.selectedModel.SEPValidation"
                                [ngClass]="{'alert-danger': !sepValidation.modelMaxValid}">
                                {{sepValidation.modelMax | customNumber}}
                            </td>
                        </tr>
                        <tr class="bg-white border-top">
                            <td>
                                Range 2
                            </td>
                            <td>
                                Model Mean -3 Std Dev
                            </td>
                            <td *ngFor="let sepValidation of model.selectedModel.SEPValidation"
                                [ngClass]="{'alert-danger': !sepValidation.modelMinus3StdDevValid}">
                                {{sepValidation.modelMinus3StdDev | customNumber}}
                            </td>
                        </tr>
                        <tr class="bg-white">
                            <td></td>
                            <td>
                                Model Mean +3 Std Dev
                            </td>
                            <td *ngFor="let sepValidation of model.selectedModel.SEPValidation"
                                [ngClass]="{'alert-danger': !sepValidation.modelPlus3StdDevValid}">
                                {{sepValidation.modelPlus3StdDev | customNumber}}
                            </td>
                        </tr>
                    </tbody>
                    <tfoot class="border-top">
                        <tr>
                            <th></th>
                            <th>
                                Validation Check
                            </th>
                            <th *ngFor="let sepValidation of model.selectedModel.SEPValidation">
                                <span *ngIf="sepValidation.isValid">
                                    Pass
                                </span>
                                <span *ngIf="!sepValidation.isValid">
                                    Fail
                                </span>
                            </th>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
        <hr>
    </div>
</div>

<div *ngIf="regressionGroupItems.length == 0" class="w-100 justify-content-center">
    <div class="text-center mt-3 pt-3 fw-bold fs-5">
        Data Validation Tables Not Available
    </div>
</div>