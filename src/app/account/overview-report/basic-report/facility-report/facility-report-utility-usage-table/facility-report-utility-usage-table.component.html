<div class="table-responsive">
    <table class="table table-sm" *ngIf="facilityReportUtilitySummary">
        <thead>
            <tr class="table-mh">
                <th></th>
                <th class="text-center" colspan="3">
                    Target Year: {{facilityReportUtilitySummary.targetYearStart | date: 'MMM, y'}} -
                    {{facilityReportUtilitySummary.targetYearEnd | date: 'MMM, y'}}
                </th>
                <th class="text-center" colspan="3">
                    Baseline Year: {{facilityReportUtilitySummary.baselineYearStart | date: 'MMM, y'}} -
                    {{facilityReportUtilitySummary.baselineYearEnd | date: 'MMM, y'}}
                </th>
            </tr>
            <tr>
                <th class="w-1">Utility</th>
                <th class="w-2">Utility Use <br> (<span [innerHTML]="facility.energyUnit | settingsLabel"></span>)</th>
                <th class="w-2">Utility Cost</th>
                <th class="w-2">Market Emissions <br> (<span>tonne CO<sub>2</sub></span>)</th>
                <th class="w-2">Location Emissions <br> (<span>tonne CO<sub>2</sub></span>)</th>
                <th class="w-2">Utility Use <br> (<span [innerHTML]="facility.energyUnit | settingsLabel"></span>)</th>
                <th class="w-2">Utility Cost</th>
                <th class="w-2">Market Emissions <br> (<span>tonne CO<sub>2</sub></span>)</th>
                <th class="w-2">Location Emissions <br> (<span>tonne CO<sub>2</sub></span>)</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let utilityUsageSummary of facilityReportUtilitySummary.utilitySummaries">
                <td>
                    {{utilityUsageSummary.source}}
                </td>
                <!--target year-->
                <td>
                    <span *ngIf="utilityUsageSummary.consumptionTargetYear">
                        {{utilityUsageSummary.consumptionTargetYear | customNumber}}
                    </span>
                    <span *ngIf="!utilityUsageSummary.consumptionTargetYear">
                        &mdash;
                    </span>
                    <span *ngIf="utilityUsageSummary.consumptionChange" class="small pl-2 pull-right green"
                        [ngClass]="{'red': utilityUsageSummary.consumptionChange > 0}">
                        ({{utilityUsageSummary.consumptionChange | customNumber}})
                    </span>
                </td>
                <td>
                    <span *ngIf="utilityUsageSummary.costTargetYear">
                        {{utilityUsageSummary.costTargetYear | customNumber:true }}
                    </span>
                    <span *ngIf="!utilityUsageSummary.costTargetYear">
                        &mdash;
                    </span>

                    <span *ngIf="utilityUsageSummary.costChange" class="small pl-2 pull-right green"
                        [ngClass]="{'red': utilityUsageSummary.costChange > 0}">
                        ({{utilityUsageSummary.costChange | customNumber:true}})
                    </span>
                </td>
                <td>
                    <span *ngIf="utilityUsageSummary.marketEmissionsTargetYear">
                        {{utilityUsageSummary.marketEmissionsTargetYear | customNumber }}
                    </span>
                    <span *ngIf="!utilityUsageSummary.marketEmissionsTargetYear">
                        &mdash;
                    </span>

                    <span *ngIf="utilityUsageSummary.marketEmissionsChange" class="small pl-2 pull-right green"
                        [ngClass]="{'red': utilityUsageSummary.marketEmissionsChange > 0}">
                        ({{utilityUsageSummary.marketEmissionsChange | customNumber}})
                    </span>
                </td>
                <td>
                    <span *ngIf="utilityUsageSummary.locationEmissionsTargetYear">
                        {{utilityUsageSummary.locationEmissionsTargetYear | customNumber }}
                    </span>
                    <span *ngIf="!utilityUsageSummary.locationEmissionsTargetYear">
                        &mdash;
                    </span>

                    <span *ngIf="utilityUsageSummary.locationEmissionsChange" class="small pl-2 pull-right green"
                        [ngClass]="{'red': utilityUsageSummary.locationEmissionsChange > 0}">
                        ({{utilityUsageSummary.locationEmissionsChange | customNumber}})
                    </span>
                </td>
                <!--baseline year-->
                <td>
                    <span *ngIf="utilityUsageSummary.consumptionBaselineYear">
                        {{utilityUsageSummary.consumptionBaselineYear | customNumber}}
                    </span>
                    <span *ngIf="!utilityUsageSummary.consumptionBaselineYear">
                        &mdash;
                    </span>
                </td>
                <td>
                    <span *ngIf="utilityUsageSummary.costBaselineYear">
                        {{utilityUsageSummary.costBaselineYear | customNumber:true }}
                    </span>
                    <span *ngIf="!utilityUsageSummary.costBaselineYear">
                        &mdash;
                    </span>
                </td>
                <td>
                    <span *ngIf="utilityUsageSummary.marketEmissionsBaselineYear">
                        {{utilityUsageSummary.marketEmissionsBaselineYear | customNumber}}
                    </span>
                    <span *ngIf="!utilityUsageSummary.marketEmissionsBaselineYear">
                        &mdash;
                    </span>
                </td>
                <td>
                    <span *ngIf="utilityUsageSummary.locationEmissionsBaselineYear">
                        {{utilityUsageSummary.locationEmissionsBaselineYear | customNumber}}
                    </span>
                    <span *ngIf="!utilityUsageSummary.locationEmissionsBaselineYear">
                        &mdash;
                    </span>
                </td>
            </tr>
        </tbody>
        <tfoot>
            <tr>
                <th>
                    Totals
                </th>
                <!--target year-->
                <th>
                    <span *ngIf="facilityReportUtilitySummary.totals.consumptionTargetYear">
                        {{facilityReportUtilitySummary.totals.consumptionTargetYear | customNumber}}
                    </span>
                    <span *ngIf="!facilityReportUtilitySummary.totals.consumptionTargetYear">
                        &mdash;
                    </span>
                    <span *ngIf="facilityReportUtilitySummary.totals.consumptionChange"
                        class="small pl-2 pull-right green"
                        [ngClass]="{'red': facilityReportUtilitySummary.totals.consumptionChange > 0}">
                        ({{facilityReportUtilitySummary.totals.consumptionChange | customNumber}})
                    </span>
                </th>
                <th>
                    <span *ngIf="facilityReportUtilitySummary.totals.costTargetYear">
                        {{facilityReportUtilitySummary.totals.costTargetYear | customNumber:true
                        }}
                    </span>
                    <span *ngIf="!facilityReportUtilitySummary.totals.costTargetYear">
                        &mdash;
                    </span>
                    <span *ngIf="facilityReportUtilitySummary.totals.costChange" class="small pl-2 pull-right green"
                        [ngClass]="{'red': facilityReportUtilitySummary.totals.costChange > 0}">
                        ({{facilityReportUtilitySummary.totals.costChange | customNumber: true}})
                    </span>
                </th>
                <th>
                    <span *ngIf="facilityReportUtilitySummary.totals.marketEmissionsTargetYear">
                        {{facilityReportUtilitySummary.totals.marketEmissionsTargetYear | customNumber}}
                    </span>
                    <span *ngIf="!facilityReportUtilitySummary.totals.marketEmissionsTargetYear">
                        &mdash;
                    </span>
                    <span *ngIf="facilityReportUtilitySummary.totals.marketEmissionsChange"
                        class="small pl-2 pull-right green"
                        [ngClass]="{'red': facilityReportUtilitySummary.totals.marketEmissionsChange > 0}">
                        ({{facilityReportUtilitySummary.totals.marketEmissionsChange | customNumber}})
                    </span>
                </th>
                <th>
                    <span *ngIf="facilityReportUtilitySummary.totals.locationEmissionsTargetYear">
                        {{facilityReportUtilitySummary.totals.locationEmissionsTargetYear | customNumber}}
                    </span>
                    <span *ngIf="!facilityReportUtilitySummary.totals.locationEmissionsTargetYear">
                        &mdash;
                    </span>
                    <span *ngIf="facilityReportUtilitySummary.totals.locationEmissionsChange"
                        class="small pl-2 pull-right green"
                        [ngClass]="{'red': facilityReportUtilitySummary.totals.locationEmissionsChange > 0}">
                        ({{facilityReportUtilitySummary.totals.locationEmissionsChange | customNumber}})
                    </span>
                </th>
                <!--baseline year-->
                <th>
                    <span *ngIf="facilityReportUtilitySummary.totals.consumptionBaselineYear">
                        {{facilityReportUtilitySummary.totals.consumptionBaselineYear | customNumber}}
                    </span>
                    <span *ngIf="!facilityReportUtilitySummary.totals.consumptionBaselineYear">
                        &mdash;
                    </span>

                </th>
                <th>
                    <span *ngIf="facilityReportUtilitySummary.totals.costBaselineYear">
                        {{facilityReportUtilitySummary.totals.costBaselineYear | customNumber:true }}
                    </span>
                    <span *ngIf="!facilityReportUtilitySummary.totals.costBaselineYear">
                        &mdash;
                    </span>
                </th>
                <th>
                    <span *ngIf="facilityReportUtilitySummary.totals.marketEmissionsBaselineYear">
                        {{facilityReportUtilitySummary.totals.marketEmissionsBaselineYear | customNumber}}
                    </span>
                    <span *ngIf="!facilityReportUtilitySummary.totals.marketEmissionsBaselineYear">
                        &mdash;
                    </span>

                </th>
                <th>
                    <span *ngIf="facilityReportUtilitySummary.totals.locationEmissionsBaselineYear">
                        {{facilityReportUtilitySummary.totals.locationEmissionsBaselineYear | customNumber}}
                    </span>
                    <span *ngIf="!facilityReportUtilitySummary.totals.locationEmissionsBaselineYear">
                        &mdash;
                    </span>

                </th>
            </tr>
        </tfoot>
    </table>
</div>