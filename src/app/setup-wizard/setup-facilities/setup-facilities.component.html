<div class="setup-wizard-content">
    <div class="row g-0 justify-content-center h-100 w-100 overflow-scroll">
        <div class="col-11 pt-4 pb-4">
            <div class="form-paper">
                <h4>Account Facilities
                </h4>
                <div class="d-flex justify-content-end">
                    <div>
                        <button class="btn btn-sm nav-btn me-2" (click)="goToUploadData()">
                            <span class="fa fa-upload"></span>
                            Upload Data
                        </button>
                        <button class="btn btn-sm btn-success" (click)="openAddFacilityModal()">
                            <span class="fa fa-plus"></span>
                            Add Facilities
                        </button>
                    </div>
                </div>
                <br>
                <ng-template [ngIf]="facilities.length > 0" [ngIfElse]="noFacilitiesBlock">
                    <div class="table-responsive">
                        <table class="table table-sm utility-data table-hover table-bordered">
                            <thead>
                                <tr>
                                    <th></th>
                                    <th>Facility</th>
                                    <th>State</th>
                                    <th>Country</th>
                                    <th class="actions">Actions</th>
                                </tr>
                            </thead>
                            <tbody class="table-group-divider">
                                <tr *ngFor="let facility of facilities">
                                    <td class="actions">
                                        <select [(ngModel)]="facility.facilityOrder" class="form-select"
                                            id="facilityOrder" name="facilityOrder"
                                            (change)="setFacilityOrder(facility)">
                                            <option *ngFor="let option of orderOptions" [ngValue]="option">{{option}}
                                            </option>
                                        </select>
                                    </td>
                                    <td><a class="click-link" (click)="goToFacility(facility)">{{facility.name}}</a>
                                    </td>
                                    <td>{{facility.state}}</td>
                                    <td>{{facility.country}}</td>
                                    <td class="actions">
                                        <div class="btn-group">
                                            <button class="btn btn-sm btn-outline" (click)="goToFacility(facility)"
                                                title="Edit">
                                                <i class="fa fa-pencil"></i>
                                            </button>
                                            <button class="btn btn-sm btn-outline" (click)="setDeleteFacility(facility)"
                                                title="Delete">
                                                <i class="fa fa-trash"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </ng-template>
                <ng-template #noFacilitiesBlock>
                    <div class="alert alert-info">
                        No facilities found for this account. Click "<span class="fa fa-plus"></span> Add Facilities" to
                        get started.
                    </div>
                </ng-template>
            </div>
        </div>
    </div>
</div>
<nav class="setup-wizard-footer navbar shadow">
    <div class="container-fluid justify-content-between">
        <button class="btn btn-dark" (click)="goBack()">
            <span class="fa fa-chevron-left"></span>
            Go Back
        </button>
        <button class="btn btn-dark" (click)="next()">
            Next
            <span class="fa fa-chevron-right"></span>
        </button>
    </div>
</nav>



<div [ngClass]="{'windowOverlay': (facilityToDelete || displayAddFacilityModal)}">
</div>
<div class="popup" [class.open]="facilityToDelete" *ngIf="facilityToDelete">
    <div class="popup-header">Delete Facility: {{facilityToDelete.name}}
        <button class="item-right" (click)="cancelFacilityDelete()">x</button>
    </div>
    <div class="popup-body">
        <p>WARNING: By deleting this facility, you are also deleting all of the data associated with it.
            Are you sure you want to preform this action?</p>
    </div>
    <div class="popup-footer text-end">
        <button class="btn btn-secondary" (click)="cancelFacilityDelete()">Cancel</button>
        <button class="btn btn-danger" (click)="confirmDeleteFacility()">Confirm Delete</button>
    </div>
</div>

<div class="popup" [class.open]="displayAddFacilityModal" *ngIf="displayAddFacilityModal">
    <div class="popup-header">Add Facilities
        <button class="item-right" (click)="cancelAddFacilities()">x</button>
    </div>
    <div class="popup-body">
        <form>
            <div class="row">
                <label for="numberOfFacilities" class="col-sm-6 col-form-label">
                    Number of Facilities
                </label>
                <div class="col-6">
                    <input class="form-control" type="number" [(ngModel)]="numberOfFacilities" name="numberOfFacilities"
                        id="numberOfFacilities" step="1" min="0">
                </div>
            </div>
        </form>
    </div>
    <div class="popup-footer text-end">
        <button class="btn btn-secondary" (click)="cancelAddFacilities()">Cancel</button>
        <button class="btn btn-success" (click)="addFacility()">
            <span class="fa fa-plus"></span>
            Add Facilities
        </button>
    </div>
</div>