<div *ngIf="facilityReport && calculating != true">
    <div class="report" [ngClass]="{'print': print}"
        *ngIf="facilityReport.savingsReportSettings.facilityAnnualResults && ((facilityReport.savingsReportSettings.facilityAnnualResultsTable) || (facilityReport.savingsReportSettings.facilityMonthlyResults && (facilityReport.savingsReportSettings.facilityMonthlyResultsTable || facilityReport.savingsReportSettings.facilityMonthlyResultsGraphs ||     facilityReport.savingsReportSettings.facilityTrailingTwelveMonthsConsumption || facilityReport.savingsReportSettings.facilityTrailingTwelveMonthsSavings)))">
        <div class="text-center">
            <h3>
                {{ facilityReport.name }}
            </h3>
            <h6>
                Generated By VERIFI
            </h6>
        </div>
        <ng-container *ngIf="facilityReport.savingsReportSettings.facilityAnnualResultsTable">
            <div class="mt-5">
                <h4>
                    Annual Facility Analysis
                </h4>
            </div>
            <div class="scroll-x">
                <app-annual-analysis-summary-table *ngIf="annualAnalysisSummaries"
                    [annualAnalysisSummary]="annualAnalysisSummaries" [analysisItem]="analysisItem"
                    [latestMonthSummary]="latestMonthSummary" [accountOrFacility]="facility" [printBlock]="'all'"
                    [inReport]="true">
                </app-annual-analysis-summary-table>
            </div>
        </ng-container>

        <ng-container
            *ngIf="facilityReport.savingsReportSettings.facilityMonthlyResults && facilityReport.savingsReportSettings.facilityMonthlyResultsTable">
            <div class="mt-5">
                <h4>
                    Monthly Facility Analysis
                </h4>
            </div>
            <div class="scroll-x">
                <app-monthly-analysis-summary-table [monthlyAnalysisSummaryData]="monthlyAnalysisSummaryData"
                    [analysisItem]="analysisItem" [facilityOrAccount]="facility" [itemsPerPage]="itemsPerPage"
                    [printBlock]="'all'" [inReport]="true">
                </app-monthly-analysis-summary-table>
            </div>
        </ng-container>

        <ng-container
            *ngIf="facilityReport.savingsReportSettings.facilityMonthlyResults && facilityReport.savingsReportSettings.facilityMonthlyResultsGraphs">
            <div class="mt-5">
                <h4>
                    Monthly Facility Analysis Graphs
                </h4>
            </div>
            <app-monthly-analysis-summary-graph *ngIf="monthlyAnalysisSummaryData"
                [monthlyAnalysisSummaryData]="monthlyAnalysisSummaryData" [analysisItem]="analysisItem"
                [facilityOrAccount]="facility">
            </app-monthly-analysis-summary-graph>

            <hr>

            <app-monthly-analysis-summary-savings-graph *ngIf="monthlyAnalysisSummaryData" [analysisItem]="analysisItem"
                [monthlyAnalysisSummaryData]="monthlyAnalysisSummaryData" [facilityOrAccount]="facility">
            </app-monthly-analysis-summary-savings-graph>

        </ng-container>

        <ng-container
            *ngIf="facilityReport.savingsReportSettings.facilityMonthlyResults && facilityReport.savingsReportSettings.facilityTrailingTwelveMonthsConsumption">
            <div class="mt-5">
                <app-rolling-energy-consumption-graph *ngIf="monthlyAnalysisSummaryData"
                    [monthlyAnalysisSummaryData]="monthlyAnalysisSummaryData" [analysisItem]="analysisItem"
                    [facilityOrAccount]="facility"></app-rolling-energy-consumption-graph>
                <hr>
            </div>
        </ng-container>
        <ng-container
            *ngIf="facilityReport.savingsReportSettings.facilityMonthlyResults && facilityReport.savingsReportSettings.facilityTrailingTwelveMonthsSavings">
            <div class="mt-5">
                <app-rolling-energy-savings-graph *ngIf="monthlyAnalysisSummaryData"
                    [monthlyAnalysisSummaryData]="monthlyAnalysisSummaryData" [analysisItem]="analysisItem"
                    [facilityOrAccount]="facility"></app-rolling-energy-savings-graph>
                <hr>
            </div>
        </ng-container>

    </div>

    <div class="report" [ngClass]="{'print': print}"
        *ngIf="facilityReport.savingsReportSettings.groupReports && ((facilityReport.savingsReportSettings.groupAnnualResultsTable) || (facilityReport.savingsReportSettings.groupMonthlyResults && (facilityReport.savingsReportSettings.groupMonthlyResultsTable || facilityReport.savingsReportSettings.groupMonthlyResultsGraphs || facilityReport.savingsReportSettings.groupTrailingTwelveMonthsConsumption || facilityReport.savingsReportSettings.groupTrailingTwelveMonthsSavings)))">
        <div class="text-center"
            *ngIf="!facilityReport.savingsReportSettings.facilityAnnualResults || (!facilityReport.savingsReportSettings.facilityAnnualResultsTable && !facilityReport.savingsReportSettings.facilityMonthlyResults)">
            <h3>
                {{ facilityReport.name }}
            </h3>
            <h6>
                Generated By VERIFI
            </h6>
        </div>
        <ng-container *ngFor="let groupSummary of groupSummaries; let i = index">
            <ng-container *ngIf="facilityReport.savingsReportSettings.groupAnnualResultsTable">
                <div class="mt-5">
                    <h4>
                        {{groupSummary.group.idbGroupId | groupName}} Annual Results
                    </h4>
                </div>
                <div class="scroll-x">
                    <app-annual-analysis-summary-table *ngIf="annualAnalysisSummaries"
                        [annualAnalysisSummary]="groupSummary.annualAnalysisSummaryData" [analysisItem]="analysisItem"
                        [latestMonthSummary]="groupSummary.latestMonthGroupSummary" [accountOrFacility]="facility"
                        [printBlock]="'all'" [inReport]="true" [group]="groupSummary.group">
                    </app-annual-analysis-summary-table>
                </div>
                <hr>
            </ng-container>
            <ng-container>
                <ng-container
                    *ngIf="facilityReport.savingsReportSettings.groupMonthlyResults && (facilityReport.savingsReportSettings.groupMonthlyResultsTable || facilityReport.savingsReportSettings.groupMonthlyResultsGraphs || facilityReport.savingsReportSettings.groupTrailingTwelveMonthsConsumption || facilityReport.savingsReportSettings.groupTrailingTwelveMonthsSavings)">
                    <div class="mt-5">
                        <h4>
                            {{groupSummary.group.idbGroupId | groupName}} Monthly Results
                        </h4>
                    </div>
                </ng-container>
                <ng-container
                    *ngIf="facilityReport.savingsReportSettings.groupMonthlyResults && facilityReport.savingsReportSettings.groupMonthlyResultsTable">
                    <div class="scroll-x">
                        <app-monthly-analysis-summary-table
                            [monthlyAnalysisSummaryData]="groupSummary.monthlyAnalysisSummaryData"
                            [analysisItem]="analysisItem" [facilityOrAccount]="facility" [itemsPerPage]="itemsPerPage"
                            [inReport]="true" [printBlock]="'all'">
                        </app-monthly-analysis-summary-table>
                        <hr>
                    </div>
                </ng-container>
                <ng-container
                    *ngIf="facilityReport.savingsReportSettings.groupMonthlyResults && facilityReport.savingsReportSettings.groupMonthlyResultsGraphs">
                    <app-monthly-analysis-summary-graph *ngIf="monthlyAnalysisSummaryData"
                        [monthlyAnalysisSummaryData]="groupSummary.monthlyAnalysisSummaryData"
                        [analysisItem]="analysisItem" [facilityOrAccount]="facility">
                    </app-monthly-analysis-summary-graph>

                    <app-monthly-analysis-summary-savings-graph *ngIf="monthlyAnalysisSummaryData"
                        [analysisItem]="analysisItem"
                        [monthlyAnalysisSummaryData]="groupSummary.monthlyAnalysisSummaryData"
                        [facilityOrAccount]="facility">
                    </app-monthly-analysis-summary-savings-graph>
                    <hr>
                </ng-container>
                <ng-container
                    *ngIf="facilityReport.savingsReportSettings.groupMonthlyResults && facilityReport.savingsReportSettings.groupTrailingTwelveMonthsConsumption">
                    <app-rolling-energy-consumption-graph *ngIf="monthlyAnalysisSummaryData"
                        [monthlyAnalysisSummaryData]="groupSummary.monthlyAnalysisSummaryData"
                        [analysisItem]="analysisItem"
                        [facilityOrAccount]="facility"></app-rolling-energy-consumption-graph>
                    <hr>
                </ng-container>
                <ng-container
                    *ngIf="facilityReport.savingsReportSettings.groupMonthlyResults && facilityReport.savingsReportSettings.groupTrailingTwelveMonthsSavings">
                    <app-rolling-energy-savings-graph *ngIf="monthlyAnalysisSummaryData"
                        [monthlyAnalysisSummaryData]="groupSummary.monthlyAnalysisSummaryData"
                        [analysisItem]="analysisItem" [facilityOrAccount]="facility"></app-rolling-energy-savings-graph>
                    <hr>
                </ng-container>
            </ng-container>
        </ng-container>
    </div>
</div>


<div class="report" *ngIf="calculating != false">
    <app-calculating-spinner [message]="'Calculating Facility Savings...'"
        [error]="calculating == 'error'"></app-calculating-spinner>
</div>

<app-facility-print-report-button></app-facility-print-report-button>