<div>
    <div *ngIf="calculatingAnalysis == false">
        <div class="report" [ngClass]="{'print': print}">
            <div class="text-center">
                <h3>
                    {{ selectedReport.name }}
                </h3>
                <h6>
                    Generated By VERIFI
                </h6>
            </div>
            <div class="w-100 x-scroll">
                <h4>
                    Annual Account Analysis
                </h4>
                <app-annual-analysis-summary-table *ngIf="annualAnalysisSummary && annualAnalysisSummary.length > 0"
                    [annualAnalysisSummary]="annualAnalysisSummary" [analysisItem]="selectedAnalysisItem"
                    [accountOrFacility]="account" [printBlock]="'all'">
                </app-annual-analysis-summary-table>

                <app-annual-analysis-summary-graph [annualAnalysisSummary]="annualAnalysisSummary"
                    [analysisItem]="selectedAnalysisItem">
                </app-annual-analysis-summary-graph>
                <div *ngIf="annualAnalysisSummary.length === 0">
                    <p>No data available for this account.</p>
                </div>
            </div>
        </div>

        <div class="report" [ngClass]="{'print': print}">
            <ng-container>
                <div *ngFor="let summary of facilitySummariesWithAnnual">
                    <h4>
                        Annual {{ summary.facilitySummary.facility.name }} Analysis
                    </h4>
                    <div class="w-100 scroll-x">
                        <app-annual-analysis-summary-table
                            *ngIf="summary.annualFacilityAnalysisSummaries && summary.annualFacilityAnalysisSummaries.length > 0"
                            [annualAnalysisSummary]="summary.annualFacilityAnalysisSummaries"
                            [analysisItem]="summary.facilitySummary.analysisItem"
                            [accountOrFacility]="summary.facilitySummary.facility" [printBlock]="'all'">
                        </app-annual-analysis-summary-table>

                        <app-annual-analysis-summary-graph
                            [annualAnalysisSummary]="summary.annualFacilityAnalysisSummaries"
                            [analysisItem]="summary.facilitySummary.analysisItem">
                        </app-annual-analysis-summary-graph>
                        <hr>
                        <div *ngIf="summary.annualFacilityAnalysisSummaries.length === 0">
                            <p>No data available for this facility.</p>
                        </div>
                    </div>
                </div>
            </ng-container>
        </div>
    </div>

    <div *ngIf="calculatingPerformance == false">
        <div class="report" [ngClass]="{'print': print}">
            <ng-container>
                <h4>
                    Facility Performance Analysis
                </h4>
                <div class="w-100 scroll-x">
                    <app-performance-report-facility-table *ngIf="performanceReport" [account]="account"
                        [performanceReport]="performanceReport" [selectedAnalysisItem]="selectedAnalysisItem"
                        [performanceReportSetup]="selectedReport.performanceReportSetup"></app-performance-report-facility-table>

                    <app-performance-chart [performanceReport]="performanceReport" [chartDataOption]="'savings'"
                        [chartDataType]="'facility'"
                        [performanceReportSetup]="selectedReport.performanceReportSetup"></app-performance-chart>
                </div>
            </ng-container>
        </div>
    </div>
</div>

<div class="w-100 justify-content-center">
    <div class="pt-5">
        <app-calculating-spinner *ngIf="calculatingPerformance != false && calculatingAnalysis != false"
            [message]="'Generating Savings Report...'"
            [error]="calculatingPerformance == 'error' || calculatingAnalysis == 'error'"></app-calculating-spinner>
    </div>
</div>

<app-print-report-button *ngIf="selectedReport"></app-print-report-button>