<div class="row">
    <div class="col-12">
        <div class="saveCancel item-right">
            <button class="btn btn-secondary" (click)="cancel()">Cancel</button>
            <button class="btn btn-primary" (click)="saveChanges()">
                <span *ngIf="addOrEdit == 'add'">Add Predictor</span>
                <span *ngIf="addOrEdit == 'edit'">Save Changes</span>
            </button>
        </div>
    </div>
</div>
<form [formGroup]="predictorForm">
    <p class="bold">Predictor Information</p>
    <div class="row">
        <div class="col-lg-6 col-md-12 col-sm-12">
            <!-- <app-label-with-tooltip [label]="'Name'" [field]="'predictorName'" [labelId]="'predictorName'"
                [isRequired]="true">
            </app-label-with-tooltip> -->
            <label class="semibold" for="name">Name</label>
            <div class="mb-3">
                <input id="name" class="form-control" type="text" formControlName="name" onfocus="this.select();"
                    minlength="0" maxlength="100">
            </div>
            <div class="alert alert-danger" *ngIf="predictorForm.get('name').hasError('required')">Predictor name is
                required</div>
        </div>
        <div class="col-lg-6 col-md-12 col-sm-12">
            <!-- <app-label-with-tooltip [label]="'Is Production?'" [field]="'isProductionPredictor'"
                [labelId]="'isProductionPredictor'" [isRequired]="false"> 
            </app-label-with-tooltip>-->
            <label class="semibold" for="isProductionPredictor">Is Production?</label>
            <div class="mb-3">
                <select id="isProductionPredictor" class="form-select" formControlName="production">
                    <option [value]="true">Yes</option>
                    <option [value]="false">No</option>
                </select>
            </div>
        </div>
        <div class="col-lg-6 col-md-12 col-sm-12">
            <!-- <app-label-with-tooltip [label]="'Unit'" [field]="'predictorUnit'" [labelId]="'predictorUnit'"
                [isRequired]="false">
            </app-label-with-tooltip> -->
            <label class="semibold" for="predictorUnit">Unit</label>
            <div class="mb-3">
                <input id="predictorUnit" class="form-control" type="text" formControlName="unit"
                    onfocus="this.select();" minlength="0" maxlength="100">
            </div>
        </div>
        <div class="col-lg-6 col-md-12 col-sm-12">
            <!-- <app-label-with-tooltip [label]="'Unit'" [field]="'predictorUnit'" [labelId]="'predictorUnit'"
                [isRequired]="false">
            </app-label-with-tooltip> -->
            <label class="semibold" for="description">Description</label>
            <div class="mb-3">
                <textarea id="description" class="form-control" type="text" formControlName="description"
                    onfocus="this.select();"></textarea>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <hr>
        </div>
        <div class="col-lg-12 col-md-12 col-sm-12">
            <!-- <app-label-with-tooltip [label]="'Is Production?'" [field]="'isProductionPredictor'"
                [labelId]="'isProductionPredictor'" [isRequired]="false"> 
            </app-label-with-tooltip>-->
            <label class="semibold" for="predictorType">Predictor Type</label>
            <div class="mb-3">
                <select id="predictorType" class="form-select" formControlName="predictorType"
                    (change)="setShowReferencePredictors()">
                    <option [value]="'Standard'">Standard</option>
                    <option [value]="'Conversion'">Conversion</option>
                    <option [value]="'Math'">Math</option>
                    <option [value]="'Weather'">Weather</option>
                </select>
            </div>
        </div>
        <!--weather-->
        <ng-container *ngIf="predictorForm.controls.predictorType.value == 'Weather'">
            <div class="col-lg-6 col-md-12 col-sm-12">
                <label class="semibold" for="weatherDataType">Weather Predictor Type</label>
                <div class="mb-3">
                    <select id="weatherDataType" class="form-select" formControlName="weatherDataType">
                        <option [value]="'HDD'">HDD</option>
                        <option [value]="'CDD'">CDD</option>
                    </select>
                </div>
            </div>
            <div class="col-lg-6 col-md-12 col-sm-12">
                <label *ngIf="predictorForm.controls.weatherDataType.value == 'HDD'" class="semibold"
                    for="degreeDayThreshold">Heating To Temperature</label>
                <label *ngIf="predictorForm.controls.weatherDataType.value == 'CDD'" class="semibold"
                    for="degreeDayThreshold">Cooling To Temperature</label>

                <div class="mb-3 input-group">
                    <input id="degreeDayThreshold" class="form-control" type="number"
                        formControlName="degreeDayThreshold" onfocus="this.select();">
                    <!--TODO: Temperature units-->
                    <span class="input-group-text">
                        &#8457;
                    </span>
                </div>
            </div>
        </ng-container>





        <!--Math/Conversion-->
        <div class="col-lg-6 col-md-12 col-sm-12" *ngIf="showReferencePredictors">
            <label class="semibold" for="referencePredictorId">Reference Predictor</label>
            <div class="mb-3">
                <select id="referencePredictorId" class="form-select" formControlName="referencePredictorId"
                    (change)="setReferencePredictorName()">
                    <option *ngFor="let predictor of referencePredictors" [value]="predictor.id">{{predictor.name}}
                    </option>
                </select>
            </div>
        </div>
        <ng-container *ngIf="predictorForm.controls.predictorType.value == 'Conversion'">
            <div class="col-lg-6 col-md-12 col-sm-12">
                <label class="semibold" for="conversionType">Conversion Type</label>
                <div class="mb-3">
                    <select id="conversionType" class="form-select" formControlName="conversionType"
                        (change)="setUnitOptions()">
                        <option *ngFor="let conversionType of unitConversionTypes" [value]="conversionType.measure">
                            {{conversionType.display}}
                        </option>
                    </select>
                </div>
            </div>
            <div class="col-lg-6 col-md-12 col-sm-12">
                <label class="semibold" for="convertFrom">Convert From</label>
                <div class="mb-3">
                    <select id="convertFrom" class="form-select" formControlName="convertFrom">
                        <option *ngFor="let unitOption of unitOptions" [value]="unitOption">
                            <span [innerHTML]="unitOption | settingsLabel"></span>
                        </option>
                    </select>
                </div>
            </div>
            <div class="col-lg-6 col-md-12 col-sm-12">
                <label class="semibold" for="convertTo">Convert To</label>
                <div class="mb-3">
                    <select id="convertTo" class="form-select" formControlName="convertTo">
                        <option *ngFor="let unitOption of unitOptions" [value]="unitOption">
                            <span [innerHTML]="unitOption | settingsLabel"></span>
                        </option>
                    </select>
                </div>
            </div>
        </ng-container>
        <ng-container *ngIf="predictorForm.controls.predictorType.value == 'Math'">
            <div class="col-lg-6 col-md-12 col-sm-12">
                <label class="semibold" for="mathAction">Math Action</label>
                <div class="mb-3">
                    <select id="mathAction" class="form-select" formControlName="mathAction">
                        <option [value]="'add'">Add (&plus;)</option>
                        <option [value]="'subtract'">Subtract (&minus;)</option>
                        <option [value]="'multiply'">Multiply (&times;)</option>
                        <option [value]="'divide'">Divide (&divide;)</option>
                    </select>
                </div>
            </div>
            <div class="col-lg-6 col-md-12 col-sm-12">
                <label class="semibold" for="mathAmount">Action Amount</label>
                <div class="mb-3 input-group">
                    <span class="input-group-text"
                        *ngIf="predictorForm.controls.mathAction.value == 'add'">&plus;</span>
                    <span class="input-group-text"
                        *ngIf="predictorForm.controls.mathAction.value == 'subtract'">&minus;</span>
                    <span class="input-group-text"
                        *ngIf="predictorForm.controls.mathAction.value == 'multiply'">&times;</span>
                    <span class="input-group-text"
                        *ngIf="predictorForm.controls.mathAction.value == 'divide'">&divide;</span>
                    <input type="number" id="mathAmount" class="form-control" formControlName="mathAmount">
                </div>
            </div>
            <div class="col-lg-6 col-md-12 col-sm-12">
                <label class="semibold" for="mathAmount">Result</label>
                <div class="mb-3">
                    {{predictorForm.controls.name.value}} &equals; {{referencePredictorName}}
                    <span *ngIf="predictorForm.controls.mathAction.value == 'add'">&plus;</span>
                    <span *ngIf="predictorForm.controls.mathAction.value == 'subtract'">&minus;</span>
                    <span *ngIf="predictorForm.controls.mathAction.value == 'multiply'">&times;</span>
                    <span *ngIf="predictorForm.controls.mathAction.value == 'divide'">&divide;</span>
                    {{predictorForm.controls.mathAmount.value}}
                </div>
            </div>
        </ng-container>
    </div>
</form>