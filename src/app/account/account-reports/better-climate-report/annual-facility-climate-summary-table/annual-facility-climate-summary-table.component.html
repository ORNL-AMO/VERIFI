<!-- <h4>
    Facility Emissions {{annualFacilitySummary.year}}
</h4>

<table class="table utility-data table-sm table-bordered table-hover">
    <thead class="sortable">
        <tr>
            <th (click)="setOrderDataField('facilityName')" [ngClass]="{'active': orderDataField == 'facilityName'}">
                Facility Name
            </th>
            <th (click)="setOrderDataField('size')" [ngClass]="{'active': orderDataField == 'size'}">
                Gross Floor Area<br>
                (Sq. Ft)
            </th>
            <!-- <th>
                Latitude
            </th>
            <th>
                Longitude
            </th> --
            <th (click)="setOrderDataField('scope1Emissions')"
                [ngClass]="{'active': orderDataField == 'scope1Emissions'}">
                Scope 1 Emissions<br>
                (Metric tons CO<sub>2</sub>e)
            </th>
            <th (click)="setOrderDataField('scope2MarketEmissions')"
                [ngClass]="{'active': orderDataField == 'scope2MarketEmissions'}">
                Scope 2 Market Emissions<br>
                (Metric tons CO<sub>2</sub>e)
            </th>
            <th (click)="setOrderDataField('scope2LocationEmissions')"
                [ngClass]="{'active': orderDataField == 'scope2LocationEmissions'}">
                Scope 2 Location Emissions<br>
                (Metric tons CO<sub>2</sub>e)
            </th>
        </tr>
    </thead>
    <tbody>
        <tr
            *ngFor="let facilitySummary of annualFacilitySummary.betterClimateYearDetails | orderBy: orderDataField: orderByDirection">
            <td>
                {{facilitySummary.facility.name}}
            </td>
            <td>
                <ng-container *ngIf="facilitySummary.facility.size">
                    {{facilitySummary.facility.size | customNumber}}
                </ng-container>
                <ng-container *ngIf="!facilitySummary.facility.size">
                    &mdash;
                </ng-container>
            </td>
            <td class="fill-cell"
                [ngStyle]="{'background-size': facilitySummary.scope1Emissions | tableFill: annualFacilitySummary.totalScope1Emissions}">
                <ng-container *ngIf="facilitySummary.scope1Emissions">
                    {{facilitySummary.scope1Emissions | customNumber}}
                </ng-container>
                <ng-container *ngIf="!facilitySummary.scope1Emissions">
                    &mdash;
                </ng-container>
            </td>
            <td class="fill-cell"
                [ngStyle]="{'background-size': facilitySummary.scope2MarketEmissions | tableFill: annualFacilitySummary.totalScope2MarketEmissions}">
                <ng-container *ngIf="facilitySummary.scope2MarketEmissions">
                    {{facilitySummary.scope2MarketEmissions | customNumber}}
                </ng-container>
                <ng-container *ngIf="!facilitySummary.scope2MarketEmissions">
                    &mdash;
                </ng-container>
            </td>
            <td class="fill-cell"
                [ngStyle]="{'background-size': facilitySummary.scope2LocationEmissions | tableFill: annualFacilitySummary.totalScope2LocationEmissions}">
                <ng-container *ngIf="facilitySummary.scope2LocationEmissions">
                    {{facilitySummary.scope2LocationEmissions | customNumber}}
                </ng-container>
                <ng-container *ngIf="!facilitySummary.scope2LocationEmissions">
                    &mdash;
                </ng-container>
            </td>
        </tr>
    </tbody>
    <tfoot>
        <tr>
            <th>
                Totals
            </th>
            <th>

            </th>
            <th>
                <ng-container *ngIf="annualFacilitySummary.totalScope1Emissions">
                    {{annualFacilitySummary.totalScope1Emissions | customNumber}}
                </ng-container>
                <ng-container *ngIf="!annualFacilitySummary.totalScope1Emissions">
                    &mdash;
                </ng-container>
            </th>
            <th>
                <ng-container *ngIf="annualFacilitySummary.totalScope2MarketEmissions">
                    {{annualFacilitySummary.totalScope2MarketEmissions | customNumber}}
                </ng-container>
                <ng-container *ngIf="!annualFacilitySummary.totalScope2MarketEmissions">
                    &mdash;
                </ng-container>
            </th>
            <th>
                <ng-container *ngIf="annualFacilitySummary.totalScope2LocationEmissions">
                    {{annualFacilitySummary.totalScope2LocationEmissions | customNumber}}
                </ng-container>
                <ng-container *ngIf="!annualFacilitySummary.totalScope2LocationEmissions">
                    &mdash;
                </ng-container>
            </th>
        </tr>
    </tfoot>
</table> -->
<table class="table utility-data table-sm table-bordered table-hover">
    <thead class="sortable">
        <tr class="table-mh">
            <th colspan="1"></th>
            <th class="text-center" [attr.colspan]="annualFacilitiesSummaries[0].betterClimateYearDetails.length">
                Emissions<br>
                (Metric tons CO<sub>2</sub>e)
            </th>
            <!-- <th class="text-center" [attr.colspan]="annualFacilitiesSummaries[0].betterClimateYearDetails.length">
                Emissions Reductions<br>
                (Metric tons CO<sub>2</sub>e)
            </th> -->
            <th class="text-center" [attr.colspan]="annualFacilitiesSummaries[0].betterClimateYearDetails.length">
                Percent Reduction
            </th>
            <th class="text-center" [attr.colspan]="annualFacilitiesSummaries[0].betterClimateYearDetails.length">
                Percent Contribution
            </th>

        </tr>

        <tr>
            <th (click)="setOrderDataField('facilityName', undefined)"
                [ngClass]="{'active': orderDataField == 'facilityName'}">
                Facility Name
            </th>
            <!--scope 1-->
            <ng-container *ngIf="emissionsType == 'scope1'">
                <ng-container
                    *ngFor="let data of annualFacilitiesSummaries[0].betterClimateYearDetails; let index = index;">
                    <th (click)="setOrderDataField('totalScope1Emissions', data.year)"
                        [ngClass]="{'active': orderDataField == 'totalScope1Emissions' && orderByYear == data.year}"
                        class="text-center">
                        {{data.year}}
                    </th>
                </ng-container>
                <!-- <ng-container
                    *ngFor="let data of annualFacilitiesSummaries[0].betterClimateYearDetails; let index = index;">
                    <th class="text-center" (click)="setOrderDataField('scope1Reductions', data.year)"
                        [ngClass]="{'active': orderDataField == 'scope1Reductions' && orderByYear == data.year}">
                        {{data.year}}
                    </th>
                </ng-container> -->
                <ng-container
                    *ngFor="let data of annualFacilitiesSummaries[0].betterClimateYearDetails; let index = index;">
                    <th class="text-center" (click)="setOrderDataField('scope1PercentReductions', data.year)"
                        [ngClass]="{'active': orderDataField == 'scope1PercentReductions' && orderByYear == data.year}">
                        {{data.year}}
                    </th>
                </ng-container>
                <ng-container
                    *ngFor="let data of annualFacilitiesSummaries[0].betterClimateYearDetails; let index = index;">
                    <th class="text-center" (click)="setOrderDataField('scope1ReductionContribution', data.year)"
                        [ngClass]="{'active': orderDataField == 'scope1ReductionContribution' && orderByYear == data.year}">
                        {{data.year}}
                    </th>
                </ng-container>
            </ng-container>
            <!--scope 2 market-->
            <ng-container *ngIf="emissionsType == 'scope2Market'">
                <ng-container
                    *ngFor="let data of annualFacilitiesSummaries[0].betterClimateYearDetails; let index = index;">
                    <th (click)="setOrderDataField('scope2MarketEmissions', data.year)"
                        [ngClass]="{'active': orderDataField == 'scope2MarketEmissions' && orderByYear == data.year}"
                        class="text-center">
                        {{data.year}}
                    </th>
                </ng-container>
                <!-- <ng-container
                    *ngFor="let data of annualFacilitiesSummaries[0].betterClimateYearDetails; let index = index;">
                    <th class="text-center" (click)="setOrderDataField('scope2MarketReductions', data.year)"
                        [ngClass]="{'active': orderDataField == 'scope2MarketReductions' && orderByYear == data.year}">
                        {{data.year}}
                    </th>
                </ng-container> -->
                <ng-container
                    *ngFor="let data of annualFacilitiesSummaries[0].betterClimateYearDetails; let index = index;">
                    <th class="text-center" (click)="setOrderDataField('scope2MarketPercentReductions', data.year)"
                        [ngClass]="{'active': orderDataField == 'scope2MarketPercentReductions' && orderByYear == data.year}">
                        {{data.year}}
                    </th>
                </ng-container>
                <ng-container
                    *ngFor="let data of annualFacilitiesSummaries[0].betterClimateYearDetails; let index = index;">
                    <th class="text-center" (click)="setOrderDataField('scope2MarketReductionContribution', data.year)"
                        [ngClass]="{'active': orderDataField == 'scope2MarketReductionContribution' && orderByYear == data.year}">
                        {{data.year}}
                    </th>
                </ng-container>
            </ng-container>
            <!--scope 2 location-->
            <ng-container *ngIf="emissionsType == 'scope2Location'">
                <ng-container
                    *ngFor="let data of annualFacilitiesSummaries[0].betterClimateYearDetails; let index = index;">
                    <th (click)="setOrderDataField('scope2LocationEmissions', data.year)"
                        [ngClass]="{'active': orderDataField == 'scope2LocationEmissions' && orderByYear == data.year}"
                        class="text-center">
                        {{data.year}}
                    </th>
                </ng-container>
                <!-- <ng-container
                    *ngFor="let data of annualFacilitiesSummaries[0].betterClimateYearDetails; let index = index;">
                    <th class="text-center" (click)="setOrderDataField('scope2LocationReductions', data.year)"
                        [ngClass]="{'active': orderDataField == 'scope2LocationReductions' && orderByYear == data.year}">
                        {{data.year}}
                    </th>
                </ng-container> -->
                <ng-container
                    *ngFor="let data of annualFacilitiesSummaries[0].betterClimateYearDetails; let index = index;">
                    <th class="text-center" (click)="setOrderDataField('scope2LocationPercentReductions', data.year)"
                        [ngClass]="{'active': orderDataField == 'scope2LocationPercentReductions' && orderByYear == data.year}">
                        {{data.year}}
                    </th>
                </ng-container>
                <ng-container
                    *ngFor="let data of annualFacilitiesSummaries[0].betterClimateYearDetails; let index = index;">
                    <th class="text-center"
                        (click)="setOrderDataField('scope2LocationReductionContribution', data.year)"
                        [ngClass]="{'active': orderDataField == 'scope2LocationReductionContribution' && orderByYear == data.year}">
                        {{data.year}}
                    </th>
                </ng-container>
            </ng-container>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let facilityData of annualFacilitiesSummaries">
            <td>
                {{facilityData.facility.name}}
            </td>
            <!--scope 1-->
            <ng-container *ngIf="emissionsType == 'scope1'">
                <ng-container *ngFor="let data of facilityData.betterClimateYearDetails; let index = index;">
                    <td class="text-center fill-cell"
                        [ngStyle]="{'background-size': data.totalScope1Emissions | tableFill: accountDetails[index].totalScope1Emissions}">
                        {{data.totalScope1Emissions | customNumber}}
                    </td>
                </ng-container>

                <!-- <ng-container *ngFor="let data of facilityData.betterClimateYearDetails; let index = index;">
                    <td class="text-center">
                        {{data.scope1Reductions| customNumber}}
                    </td>
                </ng-container> -->
                <ng-container *ngFor="let data of facilityData.betterClimateYearDetails; let index = index;">
                    <td class="text-center"
                        [ngStyle]="{'background-color': data.scope1PercentReductions | tableCellShading:facilityMaxMin[index].scope1PercentReductions.min: facilityMaxMin[index].scope1PercentReductions.max}">
                        {{data.scope1PercentReductions| number:'1.0-2'}} %
                    </td>
                </ng-container>
                <ng-container *ngFor="let data of facilityData.betterClimateYearDetails; let index = index;">
                    <td class="text-center"
                        [ngStyle]="{'background-color': data.scope1ReductionContribution | tableCellShading:facilityMaxMin[index].scope1ReductionContribution.min: facilityMaxMin[index].scope1ReductionContribution.max}">
                        {{data.scope1ReductionContribution| number:'1.0-2'}} %
                    </td>
                </ng-container>
            </ng-container>
            <!--scope 2 market-->
            <ng-container *ngIf="emissionsType == 'scope2Market'">
                <ng-container *ngFor="let data of facilityData.betterClimateYearDetails; let index = index;">
                    <td class="text-center fill-cell"
                        [ngStyle]="{'background-size': data.scope2MarketEmissions | tableFill: accountDetails[index].scope2MarketEmissions}">
                        {{data.scope2MarketEmissions | customNumber}}
                    </td>
                </ng-container>
                <!-- <ng-container *ngFor="let data of facilityData.betterClimateYearDetails; let index = index;">
                    <td class="text-center">
                        {{data.scope2MarketReductions| customNumber}}
                    </td>
                </ng-container> -->
                <ng-container *ngFor="let data of facilityData.betterClimateYearDetails; let index = index;">
                    <td class="text-center"
                        [ngStyle]="{'background-color': data.scope2MarketPercentReductions | tableCellShading:facilityMaxMin[index].scope2MarketPercentReductions.min: facilityMaxMin[index].scope2MarketPercentReductions.max}">
                        {{data.scope2MarketPercentReductions| number:'1.0-2'}} %
                    </td>
                </ng-container>
                <ng-container *ngFor="let data of facilityData.betterClimateYearDetails; let index = index;">
                    <td class="text-center"
                        [ngStyle]="{'background-color': data.scope2MarketReductionContribution | tableCellShading:facilityMaxMin[index].scope2MarketReductionContribution.min: facilityMaxMin[index].scope2MarketReductionContribution.max}">
                        {{data.scope2MarketReductionContribution| number:'1.0-2'}} %
                    </td>
                </ng-container>
            </ng-container>
            <!--scope 2 location-->
            <ng-container *ngIf="emissionsType == 'scope2Location'">
                <ng-container *ngFor="let data of facilityData.betterClimateYearDetails; let index = index;">
                    <td class="text-center fill-cell"
                        [ngStyle]="{'background-size': data.scope2LocationEmissions | tableFill: accountDetails[index].scope2LocationEmissions}">
                        {{data.scope2LocationEmissions | customNumber}}
                    </td>
                </ng-container>
                <!-- <ng-container *ngFor="let data of facilityData.betterClimateYearDetails; let index = index;">
                    <td class="text-center">
                        {{data.scope2LocationReductions| customNumber}}
                    </td>
                </ng-container> -->
                <ng-container *ngFor="let data of facilityData.betterClimateYearDetails; let index = index;">
                    <td class="text-center"
                        [ngStyle]="{'background-color': data.scope2LocationPercentReductions | tableCellShading:facilityMaxMin[index].scope2LocationPercentReductions.min: facilityMaxMin[index].scope2LocationPercentReductions.max}">
                        {{data.scope2LocationPercentReductions| number:'1.0-2'}} %
                    </td>
                </ng-container>
                <ng-container *ngFor="let data of facilityData.betterClimateYearDetails; let index = index;">
                    <td class="text-center"
                        [ngStyle]="{'background-color': data.scope2LocationReductionContribution | tableCellShading:facilityMaxMin[index].scope2LocationReductionContribution.min: facilityMaxMin[index].scope2LocationReductionContribution.max}">
                        {{data.scope2LocationReductionContribution| number:'1.0-2'}} %
                    </td>
                </ng-container>
            </ng-container>
        </tr>
    </tbody>
    <tfoot>
        <tr>
            <th>
                Totals
            </th>
            <!--scope 1-->
            <ng-container *ngIf="emissionsType == 'scope1'">
                <ng-container *ngFor="let data of accountDetails; let index = index;">
                    <th class="text-center">
                        {{data.totalScope1Emissions | customNumber}}
                    </th>
                </ng-container>
                <!-- <ng-container *ngFor="let data of accountDetails; let index = index;">
                    <th class="text-center">
                        {{data.scope1Reductions | customNumber}}
                    </th>
                </ng-container> -->
                <ng-container *ngFor="let data of accountDetails; let index = index;">
                    <th class="text-center">
                        {{data.scope1PercentReductions| number:'1.0-2'}} %
                    </th>
                </ng-container>
                <ng-container *ngFor="let data of accountDetails; let index = index;">
                    <th class="text-center">
                        <!-- {{data.scope1ReductionContribution | number:'1.0-2'}} % -->
                    </th>
                </ng-container>
            </ng-container>
            <!--scope 2 market-->
            <ng-container *ngIf="emissionsType == 'scope2Market'">
                <ng-container *ngFor="let data of accountDetails; let index = index;">
                    <th class="text-center">
                        {{data.scope2MarketEmissions | customNumber}}
                    </th>
                </ng-container>
                <!-- <ng-container *ngFor="let data of accountDetails; let index = index;">
                    <th class="text-center">
                        {{data.scope2MarketReductions | customNumber}}
                    </th>
                </ng-container> -->
                <ng-container *ngFor="let data of accountDetails; let index = index;">
                    <th class="text-center">
                        {{data.scope2MarketPercentReductions| number:'1.0-2'}} %
                    </th>
                </ng-container>
                <ng-container *ngFor="let data of accountDetails; let index = index;">
                    <th class="text-center">
                        <!-- {{data.scope1ReductionContribution | number:'1.0-2'}} % -->
                    </th>
                </ng-container>
            </ng-container>
            <!--scope 2 location-->
            <ng-container *ngIf="emissionsType == 'scope2Location'">
                <ng-container *ngFor="let data of accountDetails; let index = index;">
                    <th class="text-center">
                        {{data.scope2LocationEmissions | customNumber}}
                    </th>
                </ng-container>
                <!-- <ng-container *ngFor="let data of accountDetails; let index = index;">
                    <th class="text-center">
                        {{data.scope2LocationReductions | customNumber}}
                    </th>
                </ng-container> -->
                <ng-container *ngFor="let data of accountDetails; let index = index;">
                    <th class="text-center">
                        {{data.scope2LocationPercentReductions| number:'1.0-2'}} %
                    </th>
                </ng-container>
                <ng-container *ngFor="let data of accountDetails; let index = index;">
                    <th class="text-center">
                        <!-- {{data.scope1ReductionContribution | number:'1.0-2'}} % -->
                    </th>
                </ng-container>
            </ng-container>
        </tr>
    </tfoot>
</table>