<div class="data-wizard-content">
    <div class="row g-0 justify-content-center h-100 w-100 overflow-auto">
        <div class="col-11 pt-4 pb-4">
            <div class="form-paper">
                <h4>
                    <i class="fa fa-list-check"></i>
                    {{account.name}} To Do List:
                    <ng-container *ngIf="toDoItems.length > 0">
                        <span class="badge bg-primary float-end">{{toDoItems.length}} items</span>
                    </ng-container>

                </h4>
                <ng-container *ngIf="showMenu">
                    <div class="d-flex justify-content-between mb-3">
                        <div class="d-flex flex-column">
                            <label>To Do Options:</label>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" role="switch" id="includeOutdatedMeters"
                                    name="includeOutdatedMeters" [(ngModel)]="todoListOptions.includeOutdatedMeters"
                                    (change)="updateIncludedItems()">
                                <label class="form-check-label" for="includeOutdatedMeters">Include outdated
                                    meters</label>
                            </div>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" role="switch"
                                    id="includeOutdatedPredictors" name="includeOutdatedPredictors"
                                    [(ngModel)]="todoListOptions.includeOutdatedPredictors"
                                    (change)="updateIncludedItems()">
                                <label class="form-check-label" for="includeOutdatedPredictors">Include outdated
                                    predictors</label>
                            </div>
                            <div class="d-flex"
                                *ngIf="todoListOptions.includeOutdatedMeters || todoListOptions.includeOutdatedPredictors">
                                <select class="form-select form-select-sm" id="outdatedDays" name="outdatedDays"
                                    [(ngModel)]="todoListOptions.outdatedDays" (change)="updateIncludedItems()">
                                    <option *ngFor="let days of outdatedDaysOptions" [value]="days">
                                        Outdated after {{days}} days</option>
                                </select>
                            </div>
                        </div>
                        <div class="d-flex" *ngIf="toDoItems.length > 0">
                            <button class="btn btn-outline" (click)="goToUpload()"
                                [ngClass]="{'me-2': showWeatherButton}">
                                <span class="fa fa-upload"></span><br>
                                Upload Data
                            </button>
                            <button class="btn btn-outline" (click)="openWeatherPredictorModal()"
                                *ngIf="showWeatherButton">
                                <span class="fa fa-temperature-half"></span><br>
                                Update Weather<br> Predictors
                            </button>
                        </div>
                    </div>
                    <hr class="my-2">
                </ng-container>
                <p>
                    The following items have been identified as needing action for this account.
                </p>
                <ng-template [ngIf]="toDoItems.length > 0" [ngIfElse]="noToDoItems">
                    <ul class="list-group">
                        <li class="list-group-item list-group-item-action"
                            *ngFor="let item of toDoItems; let index = index;" [routerLink]="item.url">
                            <div class="d-flex w-100 justify-content-between">
                                <div class="p-0">
                                    {{index + 1}}.
                                    <span class="fa fa-temperature-half pe-2" *ngIf="item.isWeather"></span>
                                    <a>{{item.label}}</a>
                                </div>
                                <div *ngIf="item.facilityId">
                                    @let facility = item.facilityId | facilityItem;
                                    <span class="badge"
                                        [ngStyle]="{'background-color': facility.color}">{{facility.name}}</span>
                                </div>
                            </div>

                            <!-- <br> -->
                            <p class="fw-light mb-0 ms-3" *ngIf="item.description">
                                {{item.description}}</p>
                        </li>
                    </ul>
                </ng-template>
                <ng-template #noToDoItems>
                    <div class="alert alert-info" role="alert">
                        <i class="fa fa-check-circle"></i>
                        No items to do at this time. Proceed to data evaluation and analysis!
                    </div>
                </ng-template>
            </div>
        </div>
    </div>
</div>




<div [ngClass]="{'windowOverlay': showWeatherPredictorModal}">
</div>

<div class="popup" [class.open]="showWeatherPredictorModal" *ngIf="showWeatherPredictorModal">
    <div class="popup-header">Update Weather Predictors
        <button class="item-right" (click)="closeWeatherPredictorModal()">x</button>
    </div>
    <div class="popup-body">
        <p>
            Updating weather predictor data will add predictor data entries from the latest entry for the predictor up
            to the current month. This will not delete or modify any existing predictor data. Be sure to double check
            the new weather readings as some stations may have gaps in their data.
        </p>
    </div>
    <div class="popup-footer text-end">
        <button class="btn btn-secondary" (click)="closeWeatherPredictorModal()">Cancel</button>
        <button class="btn btn-success" (click)="updateAccountWeatherPredictors()">Confirm Update</button>
    </div>
</div>