<div class="table-responsive">
    <table class="table table-sm" *ngIf="accountReportUtilitySummary">
        <thead>
            <tr class="table-mh">
                <th></th>
                <th class="text-center" colspan="4">
                    Target Year: {{accountReportUtilitySummary.targetYearStart | date: 'MMM, y'}} -
                    {{accountReportUtilitySummary.targetYearEnd | date: 'MMM, y'}}
                </th>
                <th class="text-center" colspan="4">
                    Baseline Year: {{accountReportUtilitySummary.baselineYearStart | date: 'MMM, y'}} -
                    {{accountReportUtilitySummary.baselineYearEnd | date: 'MMM, y'}}
                </th>
            </tr>
            <tr>
                <th class="w-1">Utility</th>
                <th class="w-2">Utility Use <br> (<span [innerHTML]="account.energyUnit | settingsLabel"></span>)</th>
                <th class="w-2">Utility Cost</th>
                <th class="w-2">Market-Based <br>Emissions (<span>tonne CO<sub>2</sub>e</span>)</th>
                <th class="w-2">Location-Based <br>Emissions (<span>tonne CO<sub>2</sub>e</span>)</th>
                <th class="w-2">Utility Use <br> (<span [innerHTML]="account.energyUnit | settingsLabel"></span>)</th>
                <th class="w-2">Utility Cost</th>
                <th class="w-2">Market-Based <br>Emissions (<span>tonne CO<sub>2</sub>e</span>)</th>
                <th class="w-2">Location-Based <br>Emissions (<span>tonne CO<sub>2</sub>e</span>)</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let utilityUsageSummary of accountReportUtilitySummary.utilitySummaries">
                <td>
                    {{utilityUsageSummary.source}}
                </td>
                <!--target year-->
                <td>
                    <span *ngIf="utilityUsageSummary.consumptionTargetYear">
                        {{utilityUsageSummary.consumptionTargetYear | customNumber}}
                    </span>
                    <span *ngIf="!utilityUsageSummary.consumptionTargetYear">
                        &mdash;
                    </span>
                    <span *ngIf="utilityUsageSummary.consumptionChange" class="small ps-2 pull-right green"
                        [ngClass]="{'red': utilityUsageSummary.consumptionChange > 0}">
                        ({{utilityUsageSummary.consumptionChange | customNumber}})
                    </span>
                </td>
                <td>
                    <span *ngIf="utilityUsageSummary.costTargetYear">
                        {{utilityUsageSummary.costTargetYear | customNumber:true }}
                    </span>
                    <span *ngIf="!utilityUsageSummary.costTargetYear">
                        &mdash;
                    </span>

                    <span *ngIf="utilityUsageSummary.costChange" class="small ps-2 pull-right green"
                        [ngClass]="{'red': utilityUsageSummary.costChange > 0}">
                        ({{utilityUsageSummary.costChange | customNumber:true}})
                    </span>
                </td>
                <td>
                    <span *ngIf="utilityUsageSummary.marketEmissionsTargetYear">
                        {{utilityUsageSummary.marketEmissionsTargetYear | customNumber }}
                    </span>
                    <span *ngIf="!utilityUsageSummary.marketEmissionsTargetYear">
                        &mdash;
                    </span>

                    <span *ngIf="utilityUsageSummary.marketEmissionsChange" class="small ps-2 pull-right green"
                        [ngClass]="{'red': utilityUsageSummary.marketEmissionsChange > 0}">
                        ({{utilityUsageSummary.marketEmissionsChange | customNumber}})
                    </span>
                </td>
                <td>
                    <span *ngIf="utilityUsageSummary.locationEmissionsTargetYear">
                        {{utilityUsageSummary.locationEmissionsTargetYear | customNumber }}
                    </span>
                    <span *ngIf="!utilityUsageSummary.locationEmissionsTargetYear">
                        &mdash;
                    </span>

                    <span *ngIf="utilityUsageSummary.locationEmissionsChange" class="small ps-2 pull-right green"
                        [ngClass]="{'red': utilityUsageSummary.locationEmissionsChange > 0}">
                        ({{utilityUsageSummary.locationEmissionsChange | customNumber}})
                    </span>
                </td>


                <!--baseline prior-->
                <td>
                    <span *ngIf="utilityUsageSummary.consumptionBaselineYear">
                        {{utilityUsageSummary.consumptionBaselineYear | customNumber}}
                    </span>
                    <span *ngIf="!utilityUsageSummary.consumptionBaselineYear">
                        &mdash;
                    </span>
                </td>
                <td>
                    <span *ngIf="utilityUsageSummary.costBaselineYear">
                        {{utilityUsageSummary.costBaselineYear | customNumber:true }}
                    </span>
                    <span *ngIf="!utilityUsageSummary.costBaselineYear">
                        &mdash;
                    </span>
                </td>
                <td>
                    <span *ngIf="utilityUsageSummary.marketEmissionsBaselineYear">
                        {{utilityUsageSummary.marketEmissionsBaselineYear | customNumber}}
                    </span>
                    <span *ngIf="!utilityUsageSummary.marketEmissionsBaselineYear">
                        &mdash;
                    </span>
                </td>
                <td>
                    <span *ngIf="utilityUsageSummary.locationEmissionsBaselineYear">
                        {{utilityUsageSummary.locationEmissionsBaselineYear | customNumber}}
                    </span>
                    <span *ngIf="!utilityUsageSummary.locationEmissionsBaselineYear">
                        &mdash;
                    </span>
                </td>
            </tr>
        </tbody>
        <tfoot>
            <tr>
                <th>
                    Totals
                </th>
                <!--target year-->
                <th>
                    <span *ngIf="accountReportUtilitySummary.totals.consumptionTargetYear">
                        {{accountReportUtilitySummary.totals.consumptionTargetYear | customNumber}}
                    </span>
                    <span *ngIf="!accountReportUtilitySummary.totals.consumptionTargetYear">
                        &mdash;
                    </span>
                    <span *ngIf="accountReportUtilitySummary.totals.consumptionChange"
                        class="small ps-2 pull-right green"
                        [ngClass]="{'red': accountReportUtilitySummary.totals.consumptionChange > 0}">
                        ({{accountReportUtilitySummary.totals.consumptionChange | customNumber}})
                    </span>
                </th>
                <th>
                    <span *ngIf="accountReportUtilitySummary.totals.costTargetYear">
                        {{accountReportUtilitySummary.totals.costTargetYear | customNumber:true
                        }}
                    </span>
                    <span *ngIf="!accountReportUtilitySummary.totals.costTargetYear">
                        &mdash;
                    </span>
                    <span *ngIf="accountReportUtilitySummary.totals.costChange" class="small ps-2 pull-right green"
                        [ngClass]="{'red': accountReportUtilitySummary.totals.costChange > 0}">
                        ({{accountReportUtilitySummary.totals.costChange | customNumber: true}})
                    </span>
                </th>
                <th>
                    <span *ngIf="accountReportUtilitySummary.totals.marketEmissionsTargetYear">
                        {{accountReportUtilitySummary.totals.marketEmissionsTargetYear | customNumber}}
                    </span>
                    <span *ngIf="!accountReportUtilitySummary.totals.marketEmissionsTargetYear">
                        &mdash;
                    </span>
                    <span *ngIf="accountReportUtilitySummary.totals.marketEmissionsChange" class="small ps-2 pull-right green"
                        [ngClass]="{'red': accountReportUtilitySummary.totals.marketEmissionsChange > 0}">
                        ({{accountReportUtilitySummary.totals.marketEmissionsChange | customNumber}})
                    </span>
                </th>
                <th>
                    <span *ngIf="accountReportUtilitySummary.totals.locationEmissionsTargetYear">
                        {{accountReportUtilitySummary.totals.locationEmissionsTargetYear | customNumber}}
                    </span>
                    <span *ngIf="!accountReportUtilitySummary.totals.locationEmissionsTargetYear">
                        &mdash;
                    </span>
                    <span *ngIf="accountReportUtilitySummary.totals.locationEmissionsChange" class="small ps-2 pull-right green"
                        [ngClass]="{'red': accountReportUtilitySummary.totals.locationEmissionsChange > 0}">
                        ({{accountReportUtilitySummary.totals.locationEmissionsChange | customNumber}})
                    </span>
                </th>
                <!--baseline year-->
                <th>
                    <span *ngIf="accountReportUtilitySummary.totals.consumptionBaselineYear">
                        {{accountReportUtilitySummary.totals.consumptionBaselineYear | customNumber}}
                    </span>
                    <span *ngIf="!accountReportUtilitySummary.totals.consumptionBaselineYear">
                        &mdash;
                    </span>

                </th>
                <th>
                    <span *ngIf="accountReportUtilitySummary.totals.costBaselineYear">
                        {{accountReportUtilitySummary.totals.costBaselineYear | customNumber:true }}
                    </span>
                    <span *ngIf="!accountReportUtilitySummary.totals.costBaselineYear">
                        &mdash;
                    </span>
                </th>
                <th>
                    <span *ngIf="accountReportUtilitySummary.totals.marketEmissionsBaselineYear">
                        {{accountReportUtilitySummary.totals.marketEmissionsBaselineYear | customNumber}}
                    </span>
                    <span *ngIf="!accountReportUtilitySummary.totals.marketEmissionsBaselineYear">
                        &mdash;
                    </span>

                </th>
                <th>
                    <span *ngIf="accountReportUtilitySummary.totals.locationEmissionsBaselineYear">
                        {{accountReportUtilitySummary.totals.locationEmissionsBaselineYear | customNumber}}
                    </span>
                    <span *ngIf="!accountReportUtilitySummary.totals.locationEmissionsBaselineYear">
                        &mdash;
                    </span>

                </th>
            </tr>
        </tfoot>
    </table>
</div>